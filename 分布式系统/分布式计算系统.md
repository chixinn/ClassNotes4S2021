# 分布式计算系统W3

## Pre

1. Host 文件的作用？

2. **单机伪分布式**：进程间通信也走网络协议，localhost(本地虚拟成与本地ip相同的地址)，目前环境(云)每一次设置免密钥登陆都会失效，所以每一次进行实验都要先进行免密钥登陆的设置。

   为什么要设置免密钥登陆？Hadoop集群上为什么要设置免密钥？

   **免密钥登陆是后续分布式Sysytem实验的先决条件。**

   - 任意机器进程之间随机相互访问的安全问题
   - 安全加密每一次都要输入密码的问题？

   

3. VM option是什么？(Google查)

4. JVM是什么?它是操作系统的进程吗?scala翻译成JVM运行?(与上一题联动)

5. `$jps`  DataNode，NameNode,Secondary NameNode等都是操作系统里的进程。

## 2.3.4 文件读写一致性

HDFS采用了**一次写入多次读取**的简化一致性思想。

- 一个文件创建写入和关闭后就不能改变了
- 已写入HDFS的文件已经写入就不能修改，只允许append
- 当对一个文件进行写或追加时，NameNode将拒绝其他针对该文件的读写请求
- 同一时间只有一个进程对文件进行操作，相当于这个文件系统不能进行并发读写。

> 这是支持OLAP应用的合理简化,Trade-off设计？

1. 假如用户确实要修改怎么办？

   删了重写

2. HDFS允许修改带来的问题：

   并发控制，block和block之间**备份的一致性**也难以维护

   

## 2.4 容错机制

虽然很重要但相对简单。

故障类型：

1. 磁盘:Data Node和NameNode
2. Data Node
3. 交换机:Data Node和NameNode通信
4. NameNode
5. 数据中心:Data Node和NameNode不存在

### 2.4.1 NameNode故障

根据Secondary NameNode中的Fslmage和Editing数据进行恢复

 NameNode重新启动的复原，C.f. Chapter5/Chapter6 High Avaliability故障 Hadoop1?Hadoop2?(不展开)

### 2.4.2 DataNode

分块冗余天然解决该问题(容错)

宕机节点上面的所有数据都会被标记为不可读；定期检查备份因子，块备份因子降低需要做balance。



