# 区块链与分享型数据库

- 拜占庭容错(BFT)

- CFT
- 默克尔树
- 防篡改方式的树的组织
- 本科生：基于已有系统开发关键系统

## 比特币

- 去中心化，分布式网络
- 挖矿 POW proof of work 解难题
- 货币的发行通过比特币协议规定，总量固定，并随着时间发行的数量递减
- 通过计算机科学，数学和密码学原理确保交易成功进行。

---

### 身份管理：比特币没有监管，传统货币有监管

- 以**地址形式**存在的账户

- 比特币通过一对公钥（ID,对外公布的地址，接收转入）和私钥(支付)标识一个唯一的身份(account)

  在比特币系统里，私钥忘了就忘了，忘了就没了。

### 交易服务--UTXOs

Unspent Transaction Outputs

c.f. 账户余额模型

每一个transaction的input和output.

![截屏2021-03-02 13.43.11](https://tva1.sinaimg.cn/large/e6c9d24ely1go5icidbgsj20og0ia79j.jpg)

> 账本的数据结构是哈希链，勾联可以很好的防篡改

![截屏2021-03-02 13.45.34](https://tva1.sinaimg.cn/large/e6c9d24ely1go5iezyu2cj20gw0a8gmq.jpg)



全复制，账在ABCD四个节点都有一份完整的copy.

在互不可信的多方之间建立可信的基础设施.

如何保证数据节点保证一致性？ C.f. Raft协议。

### 特点

- 防篡改：防篡改是如何保证的？50%的攻击，哈希链，如何保证全网都改一遍呢，即保证掌握了51%以上的算力就可以改了(因为挖矿的形式嘛)。
- 可追溯：数据以append的方式来做的，而不是立即更改的。c.f.数据库的日志，防篡改不予篡改，即数据以追加的形式可追溯。
- 去中心化：P2P,互不可信的多方之间构建起的分布式账本。

Gossip 协议

希望系统更强大：集中式=>分布式,分布式存储时往往会有partition,即在存储上是扩展了。希望增加更多的机器有更多的存储or计算性能。而区块链增加节点时，仍然要有一份账在这个节点。Paxos崩溃容错。POW投票方式：cpu来投票，投两票，即拿出两倍的算力。POW是一个选主的过程，谁最厉害？挖矿，即出一道题，谁解这个题最快。c.f. RAFT的选主机制。

## 比特币--工作量证明(POW)，算力

挖矿就是解一个题目:$Y=H(X)$

如果同一时间有两个节点都猜出来这个哈希值了呢?此时就会产生分叉，此时在区块链里面采取最长链，**最长链**集中了最多的算力。

![截屏2021-03-02 14.36.15](https://tva1.sinaimg.cn/large/e6c9d24ely1go5jvq6wq7j20zc0gygqe.jpg)

公有链，没有任何的**准入机制**。联盟链，有**准入机制**。

有证了以后，以身份投票，即不需要耗费资源了。

许可链c.f.非许可链

**许可链更像一个特殊的分布式数据库**

> 为什么是51%攻击？
>
> 有分叉会怎么样



